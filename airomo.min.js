var airomo=new function(){function a(a){return"[object Array]"===Object.prototype.toString.call(a)}function b(a){return"[object Number]"===Object.prototype.toString.call(a)}function c(a){return"[object Function]"===Object.prototype.toString.call(a)}function d(){var a=navigator.userAgent.toLowerCase();return a.match(/(ipad|iphone|ipod)/g)?1:a.match(/android/g)?2:!1}if(!window.postMessage)return console.log("Not supproted browser"),null;var e=("https:"===document.location.protocol?"https://":"http://","https://api.airomo.com"),f=e+"/sdk_api.html",g=document.createElement("iframe"),h=this;this.inited=!1;var i=null,j=null,k=0,l=0,m={},n=null,o=!1,p={},q=function(){return(new Date).getTime().toString()+"_"+Math.floor(65536*(1+Math.random()))},r=function(a,b){var c=q();p[c]={query:{request:a},callback:b,process:!1},p[c].query.queueId=c,h.inited===!0&&(n.postMessage(JSON.stringify(p[c].query),e),p[c].process=!0)},s=function(a){if(a.origin===e){var b={};try{b=JSON.parse(a.data)}catch(c){return console.log("Airomo API non JSON response",c),void 0}if("airomo_loaded"===b.message){h.inited=!0,n=a.source;for(var d in p)p.hasOwnProperty(d)&&p[d].process===!1&&(n.postMessage(JSON.stringify(p[d].query),e),p[d].process=!0)}else"error"===b.message?"[object Function]"===Object.prototype.toString.call(p[b.queueId].callback)&&p[b.queueId].callback({error:!0,errorMessage:b.errorMessage},null):"[object Function]"===Object.prototype.toString.call(p[b.queueId].callback)&&p[b.queueId].callback(null,b.response)}};window.addEventListener?window.addEventListener("message",s,!1):window.attachEvent&&window.attachEvent("message",s),this.setEnv=function(a){a.clientId&&(i=a.clientId),a.apiKey&&(j=a.apiKey),a.partnerId&&(k=a.partnerId),a.channelId&&(l=a.channelId),a.properties&&(m=a.properties)},this.search=function(e,f){var g={clientId:e.clientId||i,apiKey:e.apiKey||j,partnerId:e.partnerId||k,channelId:e.channelId||l,properties:e.properties||m,ssf:e.ssf||o};if(e.url&&(g.url=e.url),e.metaKeywords&&(g.metaKeywords=e.metaKeywords),e.query&&(g.query=e.query),e.platforms)a(e.platforms)?g.platforms=e.platforms:b(e.platforms)?(g.platforms=[],g.platforms.push(e.platforms)):console.log('Airomo API warning: "platforms" option must be Array or Number');else{var h=d();h&&(g.platforms=[],g.platforms.push(h))}return e.stores&&(a(e.stores)?g.stores=e.stores:b(e.stores)?(g.stores=[],g.stores.push(e.stores)):console.log('Airomo API warning: "stores" option must be Array or Number')),e.price&&(g.price=e.price),e.categories&&(g.categories=e.categories),e.offset&&(g.offset=e.offset),e.size&&(g.size=e.size),null===g.clientId||null===g.apiKey?(f({error:!0,errorMessage:"Airomo API error: clientId and apiKey must be provided"},null),void 0):(c(f)&&r(g,f),void 0)},g.frameBorder="0",g.hSpace="0",g.marginHeight="0",g.marginWidth="0",g.scrolling="no",g.style.cssText="display:none; position:static; top:0px; margin:0px; border-style:none; left:0px;",g.width="0",g.height="0",g.src=f;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(g,t)};